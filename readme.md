# 分组折线图+柱形图+误差线+显著性标记

#### 1. 准备数据

使用 ggplot2 绘制这种分组图，需要先将宽数据转换成长数据，即把因变量的两个因子放到同一列，这里用的`melt()`函数进行转换，这样绘图时只要在`aes()`参数内设置好分组，出来的就是分两组的图了。

#### 2. 组内差异显著性检验

- 使用`group_by()`函数对数据进行分组，表示下一步的操作仅在每个组内进行。

- 使用`rstatix::t_test()`函数进行 t 检验。

- 使用`add_xy_position()`函数将各组图形的坐标信息添加到数据框中，方便后面绘图的时候根据这个位置信息把 p 值批量添加到图上。

#### 3. 绘图-条形图

- 使用`ggpubr::stat_pvalue_manual()`函数对 p 值进行可视化标记，这里的数据框就是显著性检验那一步创建的。`label`参数指定在图形中显示的显著性的标签为`p.signif`，`tip.length`参数控制标志线的长度为 0，`vjust`表示文字与标志线之间的距离为 0.2。

- 使用`theme()`函数来设置图形的边距和图例位置。`plot.margin`参数用于设置图形的边距，上边距大一些是为了给图例留出位置。`legend.position`参数用于设置图例相对于图形区域的坐标。`legend.justification`参数用于设置图例在 x 轴和 y 轴上对齐方式。

#### 4. 绘图-折线图

- 这里使用`geom_text()`函数对 p 值进行可视化标记， 用到的数据框也是显著性检验那一步创建的。

### 最重要的是：

码代码不易，如果你觉得我的教程对你有帮助，请关注：

个人小红书 **Ms.Tt (号Ttian6688)**

个人公众号 **MsTt笔记**
